package cl.usach.wazuh.agent.controller;

import cl.usach.wazuh.agent.entity.Vulnerability;
import cl.usach.wazuh.agent.service.Vulnerabilityservice;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import reactor.core.publisher.Flux;

@RestController
@RequestMapping("/api/vulnerability")
public class Vulnerabilitycontroller {

    private final Vulnerabilityservice vulnerabilityservice;

    public Vulnerabilitycontroller(Vulnerabilityservice vulnerabilityservice){
        this.vulnerabilityservice = vulnerabilityservice;
    }

    @GetMapping("/critical")
    public Flux<Vulnerability> getCriticalVulnerabilities() {
        return vulnerabilityservice.findCriticalVulnerabilities();
    }

    @PostMapping("/critical/save")
    public Flux<Vulnerability> saveCriticalVulnerabilities() {
        return vulnerabilityservice.saveCriticalVulnerabilities();
    }

}
